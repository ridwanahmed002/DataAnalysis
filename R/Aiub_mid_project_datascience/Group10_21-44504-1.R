## ----setup, include=FALSE-------------------------------------------------------------------------------------------
knitr::opts_chunk$set(echo = TRUE)


## -------------------------------------------------------------------------------------------------------------------
library(tidyverse)
library(skimr)


## -------------------------------------------------------------------------------------------------------------------
sample_data <- read_csv("/home/ridwan/Documents/aiub/data science/Dataset_MIdterm_sectoin(B).csv")


## -------------------------------------------------------------------------------------------------------------------
head(sample_data)


## -------------------------------------------------------------------------------------------------------------------
str(sample_data)


## -------------------------------------------------------------------------------------------------------------------
skim_without_charts(sample_data)


## -------------------------------------------------------------------------------------------------------------------
apply(sample_data, MARGIN = 2, FUN = function(x) sum(is.na(x)))


## -------------------------------------------------------------------------------------------------------------------
length(which(sample_data$gender=="Male"))
length(which(sample_data$gender=="Female"))

sample_data$gender <- sample_data$gender %>% replace_na('Female')




## -------------------------------------------------------------------------------------------------------------------
sample_data$smoking_history <- sample_data$smoking_history %>% replace_na("No Info")


## -------------------------------------------------------------------------------------------------------------------
sample_data <- sample_data%>% mutate(across(hypertension, ~replace_na(hypertension, median(hypertension, na.rm=TRUE))))


## -------------------------------------------------------------------------------------------------------------------
sample_data <- sample_data%>% mutate(across(age, ~replace_na(age, median(age, na.rm=TRUE))))


## -------------------------------------------------------------------------------------------------------------------
sum(is.na(sample_data))


## -------------------------------------------------------------------------------------------------------------------
sample_data2 <- sample_data


## -------------------------------------------------------------------------------------------------------------------
boxplot(sample_data2$age , main= "Boxplot of Age" , boxwex=0.1)


## -------------------------------------------------------------------------------------------------------------------
sample_data2$age[sample_data2$age > 150]


## -------------------------------------------------------------------------------------------------------------------
sample_data2$age[sample_data2$age==280] <- 54
sample_data2$age[sample_data2$age==290] <- 54


## -------------------------------------------------------------------------------------------------------------------
boxplot(sample_data2$bmi , main= "Boxplot of BMI" , boxwex=0.1)


## -------------------------------------------------------------------------------------------------------------------
sample_data2$bmi[sample_data2$bmi < 0]


## -------------------------------------------------------------------------------------------------------------------
sample_data2$bmi[sample_data2$bmi==-27.32] <- 27.32


## -------------------------------------------------------------------------------------------------------------------
plot(sample_data2$hypertension, sample_data2$heart_disease)


## -------------------------------------------------------------------------------------------------------------------
boxplot(sample_data2$blood_glucose_level , main= "Boxplot of blood_glucose_level" , boxwex=0.1)


## -------------------------------------------------------------------------------------------------------------------
diabetes_data <- sample_data2


## -------------------------------------------------------------------------------------------------------------------
ggplot(data = diabetes_data) +
geom_bar(mapping = aes(x = age, fill= gender))


## -------------------------------------------------------------------------------------------------------------------
ggplot(data = diabetes_data, aes(x=age,y=diabetes))+ geom_point(aes(color=gender))+ facet_wrap(~gender)


## -------------------------------------------------------------------------------------------------------------------
ggplot(data = diabetes_data)+ geom_bar(mapping = aes(x=smoking_history, fill=gender))


## -------------------------------------------------------------------------------------------------------------------
ggplot(data = diabetes_data, aes(x=age,y=bmi))+ geom_point(aes(color=gender))

